(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{478:function(e,t,a){e.exports=a(750)},483:function(e,t,a){},750:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(77),l=a.n(o),c=(a(483),a(484),a(64)),i=a(127),s=a(23),u=a.n(s),d=a(245),m=a(391),p=a(392),h=a(57),f=a(40),g=a(41),E=a(43),v=a(42),y=a(44),b=a(65),x=a.n(b),w=a(233),C=a(35),O=a(360),k=a(125),M=a(323);a(671).config({path:"../../../.env"});var T={root:"".concat("","/api"),send:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POST";"string"===typeof e&&(t=e);var a={method:t,credentials:"include",headers:{"Content-Type":"application/json"}};return"get"!==t.toLowerCase()&&(a.body=JSON.stringify(e)),a},currentUser:{method:"GET",endpoint:"/v1/user/me"},deleteAccount:{method:"DELETE",endpoint:"/v1/user/me/delete"},updateAccountDetails:{method:"POST",endpoint:function(e){return"/v1/user/details/".concat(e)}},login:"/login",logout:{endpoint:"/logout",method:"GET"},register:"/signup",monthlyTransactions:function(e,t,a){var n=a,r=t;return t.length<=2&&(r=(new Date).getFullYear().toString(),n=t),"/v1/transaction/".concat(e,"/monthly/").concat(r,"/").concat(n)},transactionRange:function(e,t){return"/v1/transaction/".concat(e,"/range?days=").concat(t)},allTransactions:{method:"GET",endpoint:"/v1/transaction"},yearToDate:{method:"GET",endpoint:"/v1/transaction/ytd"},yearToDateData:{method:"GET",endpoint:"/v1/transaction/ytd/data"},updateBudget:{method:"POST",endpoint:"/v1/budget"},prestoUsage:"/v1/presto/usage",prestoLogin:{endpoint:"/v1/presto/login",method:"POST"},prestoCheckLogin:{endpoint:"/v1/presto/check-login",method:"GET"}},j=a(100);var F=function(e){var t=e.cards,a=e.handleChange,n=e.currentSelection,o=function(e){var t=e.map(function(t,a){return{key:e.length>1?a+2:a+1,text:t,value:t}});return e.length>1&&t.unshift({key:1,text:"All Cards",value:"all"}),t}(t);return r.a.createElement(j.a,{item:!0,options:o,value:n,onChange:function(e,t){var n=t.value;a(n)}})},P="range",N=[{name:"last 30 days",value:30},{name:"last 60 days",value:60},{name:"last year",value:365}],S=(new Date).getMonth(),D=(new Date).getFullYear(),A=function(e){function t(){var e,a,n;Object(f.a)(this,t);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];return(n=Object(E.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(l)))).cardsArray=n.props.cards&&n.props.cards.map(function(e){return e.cardNumber}),n.state={activeSelection:N[0].name,activeSelectionValue:N[0].value,yearOrRange:"",monthOrUnit:"",searchType:"",cardNumber:"",modalOpen:!1,selectedMonth:S,selectedYear:D,url:""},n.optionsMap=(a={},Object(h.a)(a,N[0].name,N[0].value),Object(h.a)(a,N[1].name,N[1].value),Object(h.a)(a,N[2].name,N[2].value),a),n.handleItemClick=function(e){var t=n.state.cardNumber,a=n.props.history,r=e.target.textContent.toLowerCase();console.log("itemclick:",r);var o=n.optionsMap[r],l=P,c="/dashboard/".concat(t,"/").concat(l,"/").concat(o,"/").concat("days");a.push(c)},n.handleCalChange=function(e,t){var a=t.name,r=t.value;n.setState(Object(h.a)({},a,r))},n.FilterMenu=function(){var e=n.state.yearOrRange;return N.map(function(t){return r.a.createElement(w.a.Item,{key:t.name,name:t.name,active:e===t.value,onClick:n.handleItemClick})})},n}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.cardNumber,n=t.yearOrRange,o=t.searchType,l=t.monthOrUnit,c=t.modalOpen,i=t.selectedYear,s=t.selectedMonth,d=t.url,m=t.activeSelection,p=this.props,h=p.children,f=p.match,g=p.history;return console.log("datafilter:",f),r.a.createElement(x.a,{url:d,options:T.send("GET")},function(t){var d=t.data,p=t.error,f=t.loading;return console.log({data:d,error:p,loading:f}),r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{size:"large",pointing:!0,secondary:!0},!f&&!p&&r.a.createElement(w.a.Item,{header:!0},0===d.data.transactions.length?"No Transactions For This Period":"".concat(u()(d.data.transactions[0].date).format("MMMM DD YYYY")," - ").concat(u()(d.data.transactions[d.data.transactions.length-1].date).format("MMMM DD YYYY"))),f&&r.a.createElement(w.a.Item,{header:!0},"Loading..."),r.a.createElement(w.a.Menu,{position:"right"},r.a.createElement(F,{cards:e.cardsArray,currentSelection:a,handleChange:function(e){var t="/dashboard/".concat(e,"/").concat(o,"/").concat(n,"/").concat(l);g.push(t)}}),r.a.createElement(e.FilterMenu,null),r.a.createElement(w.a.Item,{name:"month",active:"month"===o,onClick:function(){e.setState({activeSelection:"month",modalOpen:!0})}},r.a.createElement(C.a,{name:"calendar"})))),h({data:d,error:p,loading:f}),r.a.createElement(O.a,{size:"tiny",open:c,onClose:e.close},r.a.createElement(O.a.Header,null,"Choose Another Date"),r.a.createElement(O.a.Content,null,r.a.createElement(M.MonthInput,{inline:!0,closable:!0,dateFormat:"M",name:"selectedMonth",maxDate:i==D?S+1:12,value:s||S+1,onChange:e.handleCalChange}),r.a.createElement(M.YearInput,{inline:!0,name:"selectedYear",closable:!0,dateFormat:"YYYY",maxDate:D,minDate:2018,value:i||D,onChange:e.handleCalChange})),r.a.createElement(O.a.Actions,null,r.a.createElement(k.a,{negative:!0,content:"Cancel",onClick:function(){return e.setState({modalOpen:!1})}}),r.a.createElement(k.a,{positive:!0,icon:"checkmark",labelPosition:"right",content:"OK",onClick:function(){var t="/dashboard/".concat(a,"/").concat(m,"/").concat(i,"/").concat(s);e.setState({modalOpen:!1}),g.push(t)}}))))})}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.cardNumber,n=e.yearOrRange,r=e.monthOrUnit,o=e.searchType;if(console.log("getderivedstatefromprops:",a,n,r,o),"err"===o)return null;if(o===P&&parseInt(n,10)>500||o===P&&parseInt(n,10)<5)return null;if("month"===o){if(parseInt(n,10)>D||parseInt(n,10)===D&&parseInt(r,10)>S+1)return null;if(parseInt(n,10)<2010||parseInt(n,10)<2010&&parseInt(r,10)<5)return null;if(parseInt(r)>12||parseInt(r)<1)return null}return console.log("PASSED VALIDATION:",a,n,r,o),a===t.cardNumber&&n===t.yearOrRange&&r===t.monthOrUnit&&o===t.searchType?null:{cardNumber:a,yearOrRange:n,monthOrUnit:r,searchType:o,url:"month"===o?"".concat(T.root).concat(T.monthlyTransactions(a,n,r)):"".concat(T.root).concat(T.transactionRange(a,n))}}}]),t}(r.a.Component);A.defaultProps={};var I=A,Y=a(252),L=function(e){var t=e.label,a=e.value,n=e.extra,o=e.extraIcon,l=e.iconName,c=e.iconColor,i=e.isCustomIcon,s=e.extraFooter,u=e.extraFooterIcon;return r.a.createElement(Y.a,{style:{flex:"1",minWidth:"230px",maxWidth:"250px",borderRadius:"6px",zIndex:"0"}},r.a.createElement(Y.a.Content,{style:{paddingLeft:"20px",paddingRight:"20px"}},r.a.createElement(Y.a.Description,null,r.a.createElement(d.a,{columns:1,verticalAlign:"middle"},r.a.createElement(d.a.Row,{verticalAlign:"center",columns:2},r.a.createElement(d.a.Column,{style:{textAlign:"left",paddingLeft:"1rem",paddingRight:"0"}},i?r.a.createElement("i",{style:{color:c,fontSize:"4rem",minHeight:"64px"},className:l}):r.a.createElement(C.a,{className:l,size:"huge",color:c})),r.a.createElement(d.a.Column,{style:{textAlign:"right",lineHeight:"1.2",paddingRight:"1rem",paddingLeft:"0"}},r.a.createElement(d.a.Row,null,r.a.createElement("div",{style:{fontSize:"1rem",fontWeight:"300"}},t)),r.a.createElement(d.a.Row,null,r.a.createElement("div",{style:{fontWeight:"600",fontSize:"2rem"}},a))))))),r.a.createElement(Y.a.Content,{extra:!0,style:{margin:"0 15px",paddingLeft:"0",fontWeight:"200",fontSize:"0.8rem"}},o&&r.a.createElement("i",{className:o})," ",n,s&&r.a.createElement("div",null,u&&r.a.createElement("i",{className:u})," ",s)))};function B(e){var t=e.data,a=e.loading,n=e.error,o=0,l=0,c=0,i=0,s=0,d=0,m=0,p=0,h=Date.now(),f=(Date.now(),0),g=0,E=0,v=0,y=!1;return a||n||(o=t.data.totalAmount,l=t.data.prevInterval.totalAmount,c=t.data.count.transfers+t.data.count.fares,i=t.data.prevInterval.count.transfers+t.data.prevInterval.count.fares,s=t.data.count.fares,d=t.data.prevInterval.count.fares,m=t.data.count.transfers,p=t.data.prevInterval.count.transfers,h=t.data.prevInterval.transactions.length?u()(t.data.prevInterval.transactions[t.data.prevInterval.transactions.length-1].date).utcOffset(0).format("DD MMM YY"):null,t.data.prevInterval.transactions.length?u()(t.data.prevInterval.transactions[0].date).utcOffset(0).format("MM/DD/YYYY"):null,console.log(t.data.prevInterval.transactions.length-1)),a||n||!t.data.lastYear||(y=!0,f=t.data.lastYear.totalAmount,g=(E=t.data.lastYear.count.fares)+(v=t.data.lastYear.count.transfers)),r.a.createElement(Y.a.Group,{centered:!0},!a&&!n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(L,{label:"Spent",value:"$".concat((o/100).toFixed(2)),extra:"$".concat(Math.abs((o-l)/100).toFixed(2)," ").concat(h?"from period ending ".concat(h):""),extraIcon:o-l>0?"ti-arrow-up":"ti-arrow-down",iconName:"ti-credit-card",isCustomIcon:!0,extraFooter:y?"$".concat(Math.abs((o-f)/100).toFixed(2)," from last year"):null,extraFooterIcon:y?o-f>0?"ti-arrow-up":"ti-arrow-down":null}),r.a.createElement(L,{label:"Taps",value:c,extra:"".concat(Math.abs(c-i)," ").concat(h?"from period ending ".concat(h):""),extraIcon:c-i>0?"ti-arrow-up":"ti-arrow-down",iconName:"ti-hand-drag",isCustomIcon:!0,extraFooter:y?"".concat(Math.abs(c-g)," from last year"):null,extraFooterIcon:y?c-g>0?"ti-arrow-up":"ti-arrow-down":null}),r.a.createElement(L,{label:"Fares",value:s,extra:"".concat(Math.abs(s-d)," ").concat(h?"from period ending ".concat(h):""),extraIcon:s-d>0?"ti-arrow-up":"ti-arrow-down",iconName:"ti-ticket",isCustomIcon:!0,extraFooter:y?"".concat(Math.abs(s-E)," from last year"):null,extraFooterIcon:y?s-E>0?"ti-arrow-up":"ti-arrow-down":null}),r.a.createElement(L,{label:"Transfers",value:m,extra:"".concat(Math.abs(m-p)," ").concat(h?"from period ending ".concat(h):""),extraIcon:m-p>0?"ti-arrow-up":"ti-arrow-down",iconName:"ti-vector",isCustomIcon:!0,extraFooter:y?"".concat(Math.abs(m-v)," from last year"):null,extraFooterIcon:y?m-v>0?"ti-arrow-up":"ti-arrow-down":null})))}B.defaultProps={};var R=B,U=a(179),z=a(388),W=a(31),H=a(32),G=a(20);function K(){var e=Object(W.a)(["\n  font-size: 0.8rem;\n  list-style: none;\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n"]);return K=function(){return e},e}function q(){var e=Object(W.a)(["\n  background: ",";\n  max-height: 10px;\n  max-width: 10px;\n  min-height: 10px;\n  min-width: 10px;\n  margin-right: 15px;\n  border-radius: 100%;\n"]);return q=function(){return e},e}function J(){var e=Object(W.a)(["\n  display: block;\n  text-decoration: none;\n  list-style: none;\n  list-style-type: none;\n  list-style-position: outside;\n  margin: 0;\n  padding: 0;\n"]);return J=function(){return e},e}function $(){var e=Object(W.a)(["\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: space-between;\n  align-items: center;\n  padding-bottom: 5px;\n\n  p {\n    font-weight: bold;\n  }\n\n  .count {\n    text-align: right;\n    padding: 0;\n    margin: 0;\n\n    .breakdown {\n      padding: 0;\n      margin: 0;\n      margin-top: -5px;\n      margin-bottom: -8px;\n      font-size: 0.7rem;\n    }\n  }\n\n  &.trip-count {\n    align-items: flex-start;\n  }\n"]);return $=function(){return e},e}function V(){var e=Object(W.a)(["\n  position: relative;\n  background: rgba(40, 42, 48, 0.7);\n  color: lightgrey;\n  border: 1px solid lightgrey;\n  border-radius: 0.25rem;\n  min-width: 400px;\n  padding: 30px 50px 40px 50px;\n  box-shadow: 0px 1px 2px 0 rgba(34, 36, 38, 0.15);\n  z-index: 1000;\n\n  header {\n    background: rgba(40, 42, 48, 0.8);\n    bottom: 0;\n    left: 0;\n    margin: 0;\n    padding: 0;\n    position: absolute;\n    width: 100%;\n    border-radius: 0 0 0.25rem 0.25rem;\n\n    h2 {\n      font-size: 1.1rem;\n      text-align: center;\n      font-weight: bold;\n      padding: 10px 5px;\n    }\n  }\n\n  footer {\n    margin: 20px 0;\n  }\n\n  h3 {\n    font-size: 1rem;\n    font-weight: bold;\n    padding: 0;\n    margin: 0;\n    margin-bottom: 5px;\n    margin-top: 15px;\n  }\n"]);return V=function(){return e},e}var _=H.a.div(V()),X=H.a.div($()),Q=H.a.ul(J()),Z=H.a.div(q(),function(e){return e.color}),ee=H.a.li(K()),te=function(e){var t=e.x,a=e.y,n=(e.stroke,e.payload);return r.a.createElement("g",{transform:"translate(".concat(t,",").concat(a,")")},r.a.createElement("text",{x:0,y:0,dy:16,textAnchor:"end",fill:"#666",transform:"rotate(-35)"},n.value))},ae=function(e){var t=e.payload;e.label;if(e.active){var a=t[0],n=t[1];return r.a.createElement(_,null,r.a.createElement("header",null,r.a.createElement("h2",null,"".concat(a.payload.dayOfWeek,", ").concat(a.payload.month," ").concat(a.payload.date,", ").concat(a.payload.year))),r.a.createElement(X,{className:"trip-count"},r.a.createElement(X,null,r.a.createElement(Z,{color:a.color}),r.a.createElement("p",null,"Taps")),r.a.createElement("div",{className:"count"},r.a.createElement("div",null,a.payload.trips),r.a.createElement("div",{className:"breakdown"},"".concat(a.payload.trips>0?"".concat(a.payload.fares.count," Fare").concat(1===a.payload.fares.count?"":"s"," | ").concat(a.payload.transfers.count," Transfer").concat(1===a.payload.transfers.count?"":"s"):"")))),r.a.createElement(X,null,r.a.createElement(X,null,r.a.createElement(Z,{color:n.color}),r.a.createElement("p",null,"Spent")),r.a.createElement("div",null,"$",a.payload.amount)),r.a.createElement("footer",null,a.payload.fares.locations.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"header"},"Fares"),r.a.createElement(Q,null,a.payload.fares.locations.map(function(e){return r.a.createElement(X,null,r.a.createElement(ee,null,e.location),r.a.createElement(ee,null,u()(e.time).utcOffset(0).format("hh:mm A")))}))),a.payload.transfers.locations.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",{className:"header"},"Transfers"),r.a.createElement(Q,null,a.payload.transfers.locations.map(function(e){return r.a.createElement(X,null,r.a.createElement(ee,null,e.location),r.a.createElement(ee,null,u()(e.time).utcOffset(0).format("hh:mm A")))})))))}return null},ne=function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0===e.length){var a=u()();return{date:a.format("DD"),dayOfWeek:a.format("dddd"),amount:"0.00",trips:0}}var n=[0,0],r=function(e,t){for(var a={},n=u()(e),r=u()(t);n<=r;)a[n.format("DD/MM/YYYY")]={amount:0,trips:0,transfers:0,fares:0,transferLocations:[],fareLocations:[]},n=n.add(1,"days");return a}(u()(e[0].date).utcOffset(0).format("YYYY-MM-DD"),u()(e[e.length-1].date).utcOffset(0).format("YYYY-MM-DD"));return e.forEach(function(e){var t=u()(e.date).utcOffset(0).format("DD/MM/YYYY"),a=parseFloat(e.amount);"Transfer"===e.type&&r[t].transferLocations.push({location:e.location,time:e.date}),"Fare Payment"!==e.type&&"Transit Pass Payment"!==e.type||r[t].fareLocations.push({location:e.location,time:e.date}),r[t].amount+=a,r[t].trips+=1,r[t].transfers+="Transfer"===e.type?1:0,r[t].fares+="Fare Payment"===e.type||"Transit Pass Payment"===e.type?1:0}),{dataset:Object.keys(r).map(function(e){var a=u()(e,"DD/MM/YYYY");return t&&(n[1]=n[1]<r[e].amount?(r[e].amount/100).toFixed(2):n[1]),n[1]=n[1]<r[e].trips?r[e].trips:n[1],{label:"".concat(a.format("MMM")," ").concat(a.format("DD")),date:a.format("DD"),dayOfWeek:a.format("dddd"),month:a.format("MMMM"),year:a.format("YYYY"),amount:(r[e].amount/100).toFixed(2),trips:r[e].trips,transfers:{count:r[e].transfers,locations:r[e].transferLocations},fares:{count:r[e].fares,locations:r[e].fareLocations}}}),domain:n}}(e.data.transactions,!0);return t.dataset?r.a.createElement("div",null,r.a.createElement(G.k,{height:300,style:{background:"#444"}},r.a.createElement(G.g,{margin:{top:20,right:30,left:0,bottom:0},data:t.dataset},r.a.createElement(G.c,{vertical:!1,stroke:"#EBEBEB"}),r.a.createElement(G.f,{dataKey:"trips",type:"monotone",stroke:"#3333cc",strokeWidth:2,dot:{r:0}}),r.a.createElement(G.f,{dataKey:"amount",type:"monotone",stroke:"#3BB4E9",strokeWidth:2,dot:{r:0}}),r.a.createElement(G.n,{allowDecimals:!1,type:"number",domain:t.domain,padding:{left:50},dataKey:"amount",tickLine:!1,axisLine:!1,stroke:"#C4C4C4"}),r.a.createElement(G.m,{dataKey:"label",tickLine:!1,axisLine:!1,tickSize:0,minTickGap:0,height:60,interval:t.dataset.length>100?10:1,tick:r.a.createElement(te,null),stroke:"#C4C4C4"}),r.a.createElement(G.l,{wrapperStyle:{zIndex:"1000"},content:r.a.createElement(ae,null)}),r.a.createElement(G.e,{iconType:"circle"})))):r.a.createElement(U.a,{placeholder:!0},r.a.createElement(p.a,{icon:!0},r.a.createElement(C.a,{name:"calendar times outline"}),"No transactions for this period."))};a(747);function re(e){var t,a=e.year,n=e.month,o=e.data,l=e.error,c=e.loading;return console.log("MonthlyOverview:",e),r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a,{style:{minHeight:"250px",padding:0,boxShadow:"none",border:"none"},loading:c},!c&&!l&&r.a.createElement(ne,{month:(t=n,["January","February","March","April","May","June","July","August","September","October","November","December"][t]),year:a,data:o.data}),!c&&l&&r.a.createElement(z.a,{error:!0},l.message)))}var oe=a(89);function le(){var e=Object(W.a)(['\n  position: relative;\n  border: 1px solid lightgrey;\n  width: 335px;\n  border-radius: 0.25rem;\n  padding: 10px;\n  margin-left: 15px;\n\n  &:hover {\n    box-shadow: 0px 1px 2px 0 rgba(34, 36, 38, 0.15);\n  }\n\n  &::before {\n    position: absolute;\n    content: "";\n\n    background: #fff;\n    top: 5px;\n    left: -1px;\n    width: 10px;\n    height: 10px;\n    border-left: 1px solid lightgrey;\n    border-bottom: 1px solid lightgrey;\n\n    transform: translateX(-50%) rotate(45deg);\n  }\n']);return le=function(){return e},e}function ce(){var e=Object(W.a)(["\n  /* position: absolute;\n  top: 0;\n  left: 100px; */\n"]);return ce=function(){return e},e}function ie(){var e=Object(W.a)(["\n  border-top: 1px solid lightgrey;\n  margin-top: 8px;\n  padding-top: 5px;\n  font-weight: bold;\n"]);return ie=function(){return e},e}function se(){var e=Object(W.a)(["\n  margin-left: 120px;\n"]);return se=function(){return e},e}function ue(){var e=Object(W.a)(["\n  position: absolute;\n  left: ",";\n  font-weight: 900;\n  top: -2px;\n  color: ",";\n"]);return ue=function(){return e},e}function de(){var e=Object(W.a)(["\n  list-style: none;\n  margin: 0;\n  margin-top: 15px;\n  margin-bottom: 40px;\n  list-style: none;\n  position: relative;\n  padding: 1px 100px;\n  color: #000;\n  font-size: 13px;\n"]);return de=function(){return e},e}function me(){var e=Object(W.a)(["\n  display: flex;\n  flex-flow: row nowrap;\n\n  position: relative;\n  margin-left: 10px;\n  padding: 0 0 10px 10px;\n"]);return me=function(){return e},e}function pe(){var e=Object(W.a)(['\n  &::before {\n    content: "";\n    width: 1px;\n    height: 100%;\n    position: absolute;\n    border-left: 3px solid ',";\n  }\n"]);return pe=function(){return e},e}function he(){var e=Object(W.a)(['\n  position: relative;\n\n  span.dot {\n    &::after {\n      content: "";\n      background: #fff;\n      width: 13px;\n      height: 13px;\n      border-radius: 50%;\n      border: 3px solid ',";\n      position: absolute;\n      top: 0;\n      left: -5px;\n    }\n  }\n\n  &:last-of-type {\n    section::before {\n      border-left: none;\n    }\n  }\n"]);return he=function(){return e},e}var fe=H.a.li(he(),function(e){return e.color||"blue"}),ge=H.a.section(pe(),function(e){return e.color||"blue"}),Ee=H.a.div(me()),ve=H.a.ul(de()),ye=H.a.div(ue(),function(e){return!0===e.AM?"-70px":"-69px"},function(e){return e.color}),be=H.a.div(se()),xe=H.a.div(ie()),we=H.a.div(ce()),Ce=H.a.div(le());function Oe(e){var t=e.data,a=e.loading,n=e.error,o=[];a||n||(o=function(e){var t={};return e.forEach(function(e){var a=u()(e.date).format("MM-DD-YYYY");t[a]?t[a].push(e):t[a]=[e]}),t}(t.data.transactions)),console.log(o);return r.a.createElement(U.a,{vertical:!0},!a&&!n&&Object.keys(o).sort(function(e,t){return e<t?1:-1}).map(function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(be,null,r.a.createElement(oe.a,null,u()(e).utcOffset(0).format("D MMM YYYY"))),r.a.createElement(ve,null,o[e].map(function(e){return r.a.createElement(fe,{color:"Transfer"===e.type?"orange":"blue"},r.a.createElement(ge,{color:"Transfer"===e.type?"orange":"blue"},r.a.createElement("span",{className:"dot"}),r.a.createElement(ye,{AM:"AM"===u()(e.date).utcOffset(0).format("A"),color:"Transfer"===e.type?"orange":"blue"},u()(e.date).utcOffset(0).format("hh:mm A")),r.a.createElement(Ee,null,r.a.createElement("div",null,r.a.createElement(oe.a,{color:"Transfer"===e.type?"orange":"blue"},"Transfer"===e.type?"Transfer".toUpperCase():"Fare Paid".toUpperCase())),r.a.createElement(we,null,r.a.createElement(Ce,null,r.a.createElement("div",{style:{display:"flex",flexFlow:"row nowrap",alignItems:"center",justifyContent:"space-between"}},r.a.createElement(oe.a,{color:"green"},e.cardNumber),r.a.createElement("div",null,"Transfer"===e.type?"":"$".concat((Math.round(100*e.amount)/1e4).toFixed(2)))),r.a.createElement(xe,null,"".concat(e.location)))))))})))}))}Oe.defaultProps={};var ke=a(389);function Me(e){var t=e.data,a=e.loading,n=e.error,o=[];if(a)return r.a.createElement("div",null,"Loading...");a||n||!t.data||(o=t.data.transactions.slice(0).sort(function(e,t){return Date.parse(e.date)>Date.parse(t.date)?-1:1}).map(function(e,t){return r.a.createElement(ke.a.Row,{positive:"Transfer"===e.type,key:e.id},r.a.createElement(ke.a.Cell,null,t+1),r.a.createElement(ke.a.Cell,null,u()(e.date).utcOffset(0).format("dddd, MMMM DD, YYYY")),r.a.createElement(ke.a.Cell,null,u()(e.date).utcOffset(0).format("hh:mm A")),r.a.createElement(ke.a.Cell,null,e.location),r.a.createElement(ke.a.Cell,null,e.agency),r.a.createElement(ke.a.Cell,null,e.type),r.a.createElement(ke.a.Cell,null,(Math.round(100*e.amount)/1e4).toFixed(2)))}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{as:"h2"},"Tap History",r.a.createElement(p.a.Subheader,null,"Some kind of text will go here")),r.a.createElement(ke.a,{celled:!0},r.a.createElement(ke.a.Header,null,r.a.createElement(ke.a.Row,null,r.a.createElement(ke.a.HeaderCell,null,"#"),r.a.createElement(ke.a.HeaderCell,null,"Date"),r.a.createElement(ke.a.HeaderCell,null,"Time"),r.a.createElement(ke.a.HeaderCell,null,"Location"),r.a.createElement(ke.a.HeaderCell,null,"Agency"),r.a.createElement(ke.a.HeaderCell,null,"Type"),r.a.createElement(ke.a.HeaderCell,null,"Amount"))),r.a.createElement(ke.a.Body,null,o)))}Me.defaultProps={};var Te=a(148),je=["#3F69AA","#006E6D","#E8B5CE","#FFD662","#8D9440","#C62168","#6B5B95","#FE840E","#BFD641","#6F9FD8"];var Fe=function(e){var t=e.data,a=e.error,n=e.loading,o=[],l="";return n?r.a.createElement("div",null,"Loading..."):(n||a||(o=function(e){var t={};return e.forEach(function(e){if("0"!==e.location)if(t[e.location]){var a=Date.parse(t[e.location].lastVisited),n=e.date;t[e.location].count+=1,t[e.location].amount+=e.amount,t[e.location].transfers+="Transfer"===e.type?1:0,t[e.location].fares+="Fare Payment"===e.type||"Transit Pass Payment"===e.type?1:0,Date.parse(e.date)>a&&(t[e.location].lastVisited=n)}else t[e.location]={count:1,amount:e.amount,lastVisited:e.date,transfers:"Transfer"===e.type?1:0,fares:"Fare Payment"===e.type||"Transit Pass Payment"===e.type?1:0}}),Object.keys(t).map(function(a){return Object(Te.a)({location:a,percent:Math.round(t[a].count/e.length*100)},t[a])}).filter(function(e){return e.count>1}).sort(function(e,t){return e.count>t.count?-1:1}).slice(0,10)}(t.data.transactions),l=0===t.data.transactions.length?"No Transactions For This Period":"".concat(u()(t.data.transactions[0].date).format("MMMM DD YYYY")," - ").concat(u()(t.data.transactions[t.data.transactions.length-1].date).format("MMMM DD YYYY")),console.log(o)),r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,{horizontal:!0},r.a.createElement(p.a,{as:"h3"},"Most Active Locations",r.a.createElement(p.a.Subheader,null,l))),r.a.createElement(G.k,{width:"100%",height:400},r.a.createElement(G.i,null,r.a.createElement(G.h,{data:o,fill:"#8884d8",dataKey:"count"},o.map(function(e,t){return r.a.createElement(G.d,{key:"cell-".concat(e.id),fill:je[t]})})),r.a.createElement(G.e,{iconType:"circle",verticalAlign:"bottom",payload:o.map(function(e,t){return{value:e.location,type:"circle",id:e.id,color:je[t]}})}),r.a.createElement(G.l,null)))))};Fe.defaultProps={};var Pe=Fe,Ne=a(61),Se=a(394);function De(){var e=Object(W.a)(["\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 40px;\n  z-index: 11;\n"]);return De=function(){return e},e}var Ae=H.a.div(De()),Ie=function(e){return r.a.createElement(Ae,null,e.children)};function Ye(){var e=Object(W.a)(["\n  padding: 0 10px;\n"]);return Ye=function(){return e},e}function Le(){var e=Object(W.a)(["\n  position: relative;\n  width: 100%;\n  height: 100%;\n  padding-top: 10px;\n  background: #ffffff;\n"]);return Le=function(){return e},e}function Be(){var e=Object(W.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n"]);return Be=function(){return e},e}var Re=H.a.div(Be()),Ue=H.a.div(Le()),ze=H.a.div(Ye()),We=function(e){return r.a.createElement(Ue,null,r.a.createElement("div",{style:{position:"relative",maxHeight:"60px"}},r.a.createElement(Ie,null,r.a.createElement(Tt,{justify:"space-around",align:"center",padding:"0 0 0 10px"},r.a.createElement(p.a,{style:{width:"100%",marginBottom:"0"},as:"h1"},"Presto Analytics"),r.a.createElement(Tt,{justify:"flex-end",padding:"0 10px 0 0"},r.a.createElement(ze,null,r.a.createElement(c.b,{to:"/login"},"Log In"))," | ",r.a.createElement(ze,null,r.a.createElement(c.b,{to:"/register"},"Sign Up")))))),r.a.createElement(Re,null,e.children))},He=a(312),Ge=a(393),Ke=function(e){return r.a.createElement(x.a,{url:"".concat(T.root).concat(T.currentUser.endpoint),options:T.send(T.currentUser.method)},function(t){return t.loading?r.a.createElement(He.a,{active:!0},r.a.createElement(Ge.a,null)):e.children(t)})},qe=a(387),Je=function(e){function t(){var e;return Object(f.a)(this,t),(e=Object(E.a)(this,Object(v.a)(t).call(this))).saveToState=function(t){e.setState(Object(h.a)({},t.target.name,t.target.value))},e.state={email:"",password:""},e}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.email,n=t.password;return r.a.createElement(Mt.Consumer,null,function(t){return r.a.createElement(x.a,{manual:!0,url:"".concat(T.root).concat(T.login),options:T.send({email:a,password:n})},function(o){var l=o.fetch,s=o.data,u=o.loading,d=o.error;return s&&"success"===s.status||t.data&&t.data.user?r.a.createElement(i.a,{to:"/dashboard"}):r.a.createElement("div",null,d&&r.a.createElement(z.a,{error:!0},r.a.createElement(z.a.Header,null,"An error occured"),d.message),r.a.createElement("div",{style:{minWidth:"35%"}},r.a.createElement(z.a,{attached:!0,header:"Log in",content:"Enter your email address and password to log in to your account"}),r.a.createElement(qe.a,{className:"attached fluid segment"},r.a.createElement(qe.a.Input,{fluid:!0,iconPosition:"left",placeholder:"Email"},r.a.createElement(C.a,{name:"at"}),r.a.createElement("input",{disabled:u,type:"text",name:"email",onChange:e.saveToState,value:a})),r.a.createElement(qe.a.Input,{fluid:!0,iconPosition:"left",placeholder:"Password"},r.a.createElement(C.a,{name:"key"}),r.a.createElement("input",{disabled:u,type:"password",name:"password",onChange:e.saveToState,value:n})),r.a.createElement("div",{style:{textAlign:"right"}},r.a.createElement(k.a,{style:{marginRight:0},positive:!0,labelPosition:"right",icon:"chevron circle right",content:"Login",disabled:u||!a.length||!n.length,loading:u,onClick:function(){l(),e.setState({email:"",password:""})}}))),r.a.createElement(z.a,{attached:"bottom",warning:!0},r.a.createElement(C.a,{name:"help"}),"Don't have an account?",r.a.createElement(c.b,{to:"/register"}," Register"),"\xa0instead.")))})})}}]),t}(n.Component),$e=a(24),Ve=a.n($e),_e=a(34),Xe=a(1),Qe=a.n(Xe),Ze=a(426);function et(){return(et=Object(_e.a)(Ve.a.mark(function e(t,a,n){var r,o,l,c,i,s=arguments;return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>3&&void 0!==s[3]?s[3]:{},o="".concat(T.root),l=Object.assign({},r.headers||{},{"Content-Type":"application/json; charset=UTF-8"}),e.next=5,t("".concat(o).concat(a),Object.assign({method:n,credentials:"include"},r,{headers:l,body:JSON.stringify(r.body)}));case 5:return c=e.sent,e.next=8,c.json();case 8:return i=e.sent,e.abrupt("return",i);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var tt,at=(tt=fetch,function(e,t,a){return function(e,t,a){return et.apply(this,arguments)}(tt,e,t,a)});function nt(){return(nt=Object(_e.a)(Ve.a.mark(function e(t){var a;return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(T.logout.endpoint,T.logout.method);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function rt(){return(rt=Object(_e.a)(Ve.a.mark(function e(t){var a;return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(T.deleteAccount.endpoint,T.deleteAccount.method,{body:{verify:"yes"}});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ot(){return(ot=Object(_e.a)(Ve.a.mark(function e(t,a){var n,r,o=arguments;return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:{},e.next=3,t(T.updateAccountDetails.endpoint(a),T.updateAccountDetails.method,{body:Object(Te.a)({},n)});case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function lt(){return(lt=Object(_e.a)(Ve.a.mark(function e(t,a,n){var r;return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(T.prestoLogin.endpoint,T.prestoLogin.method,{body:{username:a,password:n}});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ct(){return(ct=Object(_e.a)(Ve.a.mark(function e(t){var a;return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(T.prestoCheckLogin.endpoint,T.prestoCheckLogin.method);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function it(){return(it=Object(_e.a)(Ve.a.mark(function e(t){var a,n,r=arguments;return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:{},e.next=3,t(T.updateBudget.endpoint,T.updateBudget.method,{body:Object(Te.a)({},a)});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function st(){return(st=Object(_e.a)(Ve.a.mark(function e(t){var a;return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(T.currentUser.endpoint,T.currentUser.method);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ut,dt=function(e){return st.apply(this,arguments)},mt=(ut=at,{logout:function(){return function(e){return nt.apply(this,arguments)}(ut)},deleteAccount:function(){return function(e){return rt.apply(this,arguments)}(ut)},prestoLogin:function(e,t){return function(e,t,a){return lt.apply(this,arguments)}(ut,e,t)},prestoIsLoggedIn:function(){return function(e){return ct.apply(this,arguments)}(ut)},updateBudget:function(e){return function(e){return it.apply(this,arguments)}(ut,e)},updateUserDetails:function(e,t){return function(e,t){return ot.apply(this,arguments)}(ut,e,t)},me:function(){return dt(ut)}}),pt=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(E.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={firstName:a.props.props.data.user.firstName,lastName:a.props.props.data.user.lastName,email:a.props.props.data.user.email,monthlyPassCost:a.props.props.data.budget?a.props.props.data.budget.monthlyPassCost:0,fareCost:a.props.props.data.budget?a.props.props.data.budget.fareCost:0,updateMessage:""},a.handleFieldChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(h.a)({},n,r))},a.handleDeleteAccount=Object(_e.a)(Ve.a.mark(function e(){return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt.deleteAccount();case 2:"success"===e.sent.status&&a.props.history.push("/login");case 4:case"end":return e.stop()}},e)})),a.handleUpdateUserDetails=function(){var e=Object(_e.a)(Ve.a.mark(function e(t){var n,r,o,l,c;return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state,r=n.firstName,o=n.lastName,l=n.email,c={firstName:r,lastName:o,email:l},e.next=4,mt.updateUserDetails(t,c);case 4:"success"===e.sent.status&&a.setState({updateMessage:"Account details successfully updated."});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleUpdateBudgetDetails=Object(_e.a)(Ve.a.mark(function e(){var t,n,r,o;return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,n=t.monthlyPassCost,r=t.fareCost,o={monthlyPassCost:n,fareCost:r},e.next=4,mt.updateBudget(o);case 4:"success"===e.sent.status&&a.setState({updateMessage:"Budget details successfully updated."});case 6:case"end":return e.stop()}},e)})),a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.firstName,n=t.lastName,o=t.email,l=t.monthlyPassCost,c=t.fareCost,i=t.updateMessage,s=this.props.props.data.user.id;return r.a.createElement("div",null,r.a.createElement(p.a,{as:"h2"},"Account Settings",r.a.createElement(p.a.Subheader,null,"Manage your account settings")),i&&r.a.createElement(z.a,{positive:!0,header:"Account Details Updated",content:i}),r.a.createElement(p.a,{as:"h3",attached:"top"},r.a.createElement(C.a,{name:"user"}),"Personal Information"),r.a.createElement(U.a,{attached:!0},r.a.createElement(qe.a,null,r.a.createElement(qe.a.Group,{widths:"equal"},r.a.createElement(qe.a.Field,null,r.a.createElement("label",{htmlFor:"firstName"},"First Name",r.a.createElement("input",{id:"firstName",placeholder:"First Name",value:a,name:"firstName",onChange:this.handleFieldChange}))),r.a.createElement(qe.a.Field,null,r.a.createElement("label",{htmlFor:"lastName"},"Last Name",r.a.createElement("input",{id:"lastName",placeholder:"Last Name",value:n,name:"lastName",onChange:this.handleFieldChange})))),r.a.createElement(qe.a.Group,{widths:"equal"},r.a.createElement(qe.a.Field,null,r.a.createElement("label",{htmlFor:"email"},"Email",r.a.createElement("input",{id:"email",placeholder:"Email",value:o,name:"email",onChange:this.handleFieldChange}))),r.a.createElement(qe.a.Field,null,r.a.createElement("label",{htmlFor:"password"},"Password",r.a.createElement("input",{id:"password",placeholder:"Password",onChange:this.handleFieldChange})))),r.a.createElement(k.a,{positive:!0,onClick:function(){return e.handleUpdateUserDetails(s)}},"Save"))),r.a.createElement(p.a,{as:"h3",attached:"top"},r.a.createElement(C.a,{name:"bus"}),"Transit Costs"),r.a.createElement(U.a,{attached:!0},r.a.createElement(qe.a,null,r.a.createElement(qe.a.Group,{widths:"equal"},r.a.createElement(qe.a.Field,null,r.a.createElement("label",{htmlFor:"monthlyPassCost"},"Monthly Pass Cost",r.a.createElement("input",{type:"number",id:"monthlyPassCost",placeholder:"Monthly Pass Cost",value:l,name:"monthlyPassCost",onChange:this.handleFieldChange}))),r.a.createElement(qe.a.Field,null,r.a.createElement("label",{htmlFor:"fareCost"},"Single Fare Cost",r.a.createElement("input",{type:"number",id:"fareCost",placeholder:"Single Fare Cost",value:c,name:"fareCost",onChange:this.handleFieldChange})))),r.a.createElement(k.a,{positive:!0,onClick:function(){return e.handleUpdateBudgetDetails()}},"Save"))),r.a.createElement(p.a,{as:"h3",attached:"top",color:"red"},r.a.createElement(C.a,{name:"delete"}),"Delete Account"),r.a.createElement(U.a,{attached:!0,color:"red",textAlign:"center"},r.a.createElement(Ze.a,{trigger:r.a.createElement(k.a,{color:"red",icon:"cancel",content:"Delete My Account"}),on:"click",position:"top right"},r.a.createElement(d.a,{centered:!0},r.a.createElement(d.a.Column,{textAlign:"center"},r.a.createElement("p",null,"This action cannot be undone"),r.a.createElement(k.a,{color:"green",content:"Confirm Delete",onClick:function(){return e.handleDeleteAccount()}}))))))}}]),t}(n.Component);pt.defaultProps={budget:Qe.a.shape({monthlyPassCost:"146.25",fareCost:"3.00"})};var ht=Object(i.e)(pt),ft=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(E.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:"",inProgress:!1,progressMessage:"Fetching Data from Presto...",isError:!1,cards:[]},a.handleTextEntry=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(h.a)({},n,r))},a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.password,o=t.cards,l=t.inProgress,c=t.progressMessage,i=t.isError,s=this.props,u=s.incrementSteps,d=s.update,m=s.closeModal;return o&&console.log(o.map(function(e){return e.cardNumber})),r.a.createElement(x.a,{manual:!0,url:"".concat(T.root).concat(T.prestoUsage),options:T.send({from:"01/01/2018",cards:o.map(function(e){return e.cardNumber})})},function(t){var o=t.fetch,s=t.data,p=(t.error,t.loading);console.log(s),!p&&s&&(e.setState({inProgress:!1,progressMessage:"Complete!"}),d?m():u());return r.a.createElement("div",null,p||l?r.a.createElement(z.a,{attached:!0,icon:!0},r.a.createElement(C.a,{name:"circle notched",loading:!0}),r.a.createElement(z.a.Content,null,r.a.createElement(z.a.Header,null,"One Moment"),c)):i?r.a.createElement(z.a,{attached:!0,icon:!0,negative:!0},r.a.createElement(C.a,{name:"delete"}),r.a.createElement(z.a.Content,null,r.a.createElement(z.a.Header,null,"An Error Occurred"),c)):r.a.createElement(z.a,{attached:!0,header:"Sign in to Presto",content:"Enter your username and password to gather your presto data"}),r.a.createElement(qe.a,{className:"attached fluid segment"},r.a.createElement(qe.a.Group,{widths:"equal"},r.a.createElement(qe.a.Input,{fluid:!0,placeholder:"Username",label:"Username",disabled:p||l,type:"text",name:"username",onChange:e.handleTextEntry,value:a}),r.a.createElement(qe.a.Input,{fluid:!0,placeholder:"Password",label:"Password",disabled:p||l,type:"password",name:"password",onChange:e.handleTextEntry,value:n})),r.a.createElement("div",null,r.a.createElement(k.a,{positive:!0,labelPosition:"right",icon:"chevron circle right",content:"Next",disabled:p||l||!a||!n,onClick:Object(_e.a)(Ve.a.mark(function t(){var r;return Ve.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({inProgress:!0,progressMessage:"Logging into PRESTO..."}),e.setState({inProgress:!0,progressMessage:"Getting account data..."}),t.next=4,mt.prestoLogin(a,n);case 4:r=t.sent,console.log(r),r.cards?(e.setState({cards:r.cards,inProgress:!0,progressMessage:"Fetching PRESTO usage data..."}),o()):r.error&&"INVALID_LOGIN"===r.message?e.setState({inProgress:!1,isError:!0,progressMessage:"You've entered an incorrect Presto username or password."}):r.error&&"INVALID_LOGIN"!==r.message&&e.setState({inProgress:!1,isError:!0,progressMessage:r.error});case 7:case"end":return t.stop()}},t)}))},r.a.createElement(C.a,{name:"checkmark"}),"".concat(d?l&&"Complete!"===c?" Close":" Update":" Next")),d&&r.a.createElement(k.a,{negative:!0,content:"Cancel",disabled:l,onClick:function(){m()}}," Cancel"))))})}}]),t}(n.Component),gt=function(e){var t=e.open,a=e.close;return r.a.createElement(r.a.Fragment,null,r.a.createElement(O.a,{open:t,size:"tiny"},r.a.createElement(ft,{update:!0,closeModal:a})))};function Et(){var e=Object(W.a)(["\n  height: 100%;\n  padding: 20px;\n"]);return Et=function(){return e},e}H.a.nav(Et());var vt=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(E.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={activeSelection:"this month",accountModalOpen:!1,prestoModalOpen:!1},a.handleItemClick=function(){var e=Object(_e.a)(Ve.a.mark(function e(t,n){var r;return Ve.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("update"===(r=n.name)&&a.setState({prestoModalOpen:!0}),"logout"!==r){e.next=6;break}return e.next=5,mt.logout();case 5:a.props.history.push("/login");case 6:"dashboard"===r&&a.props.history.push("/dashboard"),"settings"===r&&a.props.history.push("/settings");case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleAccountModalClose=function(){a.setState({accountModalOpen:!1})},a.handlePrestoModalClose=function(){a.setState({prestoModalOpen:!1})},a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.top,e.budget,e.user,this.state.prestoModalOpen);return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{fixed:"left",icon:"labeled",size:"small",compact:!0,pointing:!0,secondary:!0,inverted:!0,vertical:!0,style:{background:"rgb(36,41,46)",color:"#333845",fontSize:"1rem",display:"flex",flexDirection:"column",alignContent:"center"}},r.a.createElement("div",{style:{margin:"auto 0",width:"65px"}},r.a.createElement(w.a.Item,{header:!0}),r.a.createElement(w.a.Menu,{position:"right"},r.a.createElement(w.a.Item,{name:"dashboard",onClick:this.handleItemClick},r.a.createElement(C.a,{name:"dashboard",size:"large"})),r.a.createElement(w.a.Item,{name:"update",onClick:this.handleItemClick},r.a.createElement(C.a,{name:"refresh",size:"large"})),r.a.createElement(w.a.Item,{name:"settings",onClick:this.handleItemClick},r.a.createElement(C.a,{name:"setting",size:"large"})),r.a.createElement(w.a.Item,{name:"logout",onClick:this.handleItemClick},r.a.createElement(C.a,{name:"log out",size:"large"}))))),r.a.createElement(gt,{open:t,close:this.handlePrestoModalClose}))}}]),t}(n.Component),yt=Object(i.e)(vt),bt=function(e){var t=e.header,a=e.body,n=e.footer;return r.a.createElement(d.a,{columns:1,style:{marginTop:"0"}},r.a.createElement(d.a.Row,{verticalAlign:"center",columns:1},r.a.createElement(d.a.Column,{style:{textAlign:"right",lineHeight:"1.2"}},r.a.createElement(d.a.Row,null,r.a.createElement("div",{style:{fontSize:"1rem",fontWeight:"300"}},t)),r.a.createElement(d.a.Row,null,r.a.createElement("div",{style:{width:"100%",fontWeight:"600",fontSize:"1.3rem"}},a)),r.a.createElement(d.a.Row,null,r.a.createElement("div",{style:{fontSize:".9rem",fontWeight:"200",color:"#ababab"}},n)))))},xt=function(e){e.firstName,e.lastName;var t=e.cards,a=e.balance,n=e.lastActivity,o=e.amount,l=e.since;return r.a.createElement("div",{style:{background:"white",marginLeft:"67px",padding:"10px",borderBottom:"1px solid lightgrey"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%"}},r.a.createElement(bt,{header:"Balance",body:"$".concat((Math.round(100*a)/100).toFixed(2)),footer:"over ".concat(t.length," card").concat(1!==t.length?"s":"")}),r.a.createElement(bt,{header:"Spent",body:"$".concat(Math.round(o/100)),footer:"since ".concat(u()(l).format("MMM YYYY"))}),r.a.createElement(bt,{header:"Last Charge",body:"$".concat(parseFloat(n.amount/100).toFixed(2)),footer:"".concat(u()(n.date).fromNow())}),r.a.createElement(bt,{header:"Location",body:n.location,footer:"".concat(u()(n.date).fromNow())}),r.a.createElement(bt,{header:"Updated",body:u()(n.updated_at).fromNow()})))};xt.defaultProps={};var wt=xt;function Ct(){var e=Object(W.a)(["\n  display: flex;\n  position: relative;\n  flex-wrap: nowrap;\n  width: ",";\n  flex-direction: row;\n  align-items: ",";\n  justify-content: ",";\n  padding: ",";\n"]);return Ct=function(){return e},e}function Ot(){var e=Object(W.a)(["\n  border-radius: 0.7em;\n  margin-left: 30px;\n  min-height: 400px;\n  margin-right: 15px;\n  /* border: 1px solid lightgrey; */\n  /* background: white; */\n  margin-top: 10px;\n  box-shadow: 0 1px 6px rgba(32, 33, 36, 0.28);\n  padding: 10px;\n"]);return Ot=function(){return e},e}function kt(){var e=Object(W.a)(["\n  position: relative;\n  width: 100%;\n  color: white;\n  z-index: 1;\n"]);return kt=function(){return e},e}var Mt=r.a.createContext(),Tt=(H.a.div(kt()),H.a.main(Ot()),H.a.div(Ct(),function(e){return e.width||"100%"},function(e){return e.align||"stretch"},function(e){return e.justify||"stretch"},function(e){return e.padding||"0"})),jt=function(e){function t(){var e,a;Object(f.a)(this,t);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return(a=Object(E.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(o)))).state={menuValue:"",updatePrestoOpen:!1,accountSettingsOpen:!1,redirect:!1},a.contextRef=Object(n.createRef)(),a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.children,n=t.loginRequired,o=this.state;o.menuValue,o.accountSettingsOpen;return r.a.createElement(Ke,null,function(t){var o=t.data,l=t.error,c=t.loading;if(!c&&l&&n)return r.a.createElement(We,null,l&&r.a.createElement(z.a,{error:!0},l.message),r.a.createElement(Mt.Provider,{value:{data:o,error:l}},r.a.createElement(Je,null)));if(!c&&l&&!n)return r.a.createElement(We,null,r.a.createElement(Mt.Provider,{value:{data:o,error:l}},a));if(!c&&o&&"success"===o.status){var i=o.data,s=i.user,u=i.budget,m=i.balance,p=i.lastActivity,h=i.spent,f=h.amount,g=h.since;return console.log(o),r.a.createElement(r.a.Fragment,null,r.a.createElement(yt,null),r.a.createElement(Ne.a,{innerRef:e.contextRef},r.a.createElement(d.a,{style:{paddingTop:0}},r.a.createElement(d.a.Row,null,r.a.createElement(d.a.Column,null,r.a.createElement(Se.a,{context:e.contextRef},r.a.createElement(wt,{firstName:s.firstName,lastName:s.lastName,cards:s.cards,balance:m,budget:u,amount:g?f:"N/A",since:g||"Never",lastActivity:0===p.length?{amount:"Never",location:"N/A",date:"Never"}:p[0]})))),r.a.createElement(d.a.Row,null,r.a.createElement(d.a.Column,{style:{marginLeft:"80px",marginRight:"10px"}},r.a.createElement(Mt.Provider,{value:{data:o.data}},a))))))}})}}]),t}(n.Component),Ft=function(e){console.log(e);var t=e.dataset;return r.a.createElement("div",null,r.a.createElement(Tt,{justify:"space-between",align:"center"},r.a.createElement("h3",{style:{marginTop:"0",marginBottom:"0",marginLeft:"25px",color:"#11BB81"}},"Year to Month"),r.a.createElement("h3",{style:{marginTop:"0",marginRight:"30px",color:"#3BB4E9"}},"$".concat((t.totalAmount/100).toFixed(2)," Total"))),r.a.createElement(G.k,{height:200},r.a.createElement(G.g,{margin:{top:20,right:30,left:0,bottom:0},data:t.data},r.a.createElement(G.c,{stroke:"#EBEBEB",vertical:!1}),r.a.createElement(G.f,{dataKey:"paymentTaps",type:"monotone",stroke:"#3333cc",strokeWidth:5,dot:{stroke:"white",strokeWidth:3,fill:"#3333cc",r:7}}),r.a.createElement(G.f,{dataKey:"transferTaps",type:"monotone",stroke:"#11BB81",strokeWidth:5,dot:{stroke:"white",strokeWidth:3,fill:"#11BB81",r:7}}),r.a.createElement(G.f,{dataKey:"amount",type:"monotone",stroke:"#3BB4E9",strokeWidth:5,dot:{stroke:"white",strokeWidth:3,fill:"#3BB4E9",r:7}}),r.a.createElement(G.n,{type:"number",tickMargin:20,dataKey:"amount",tickLine:!1,axisLine:!1,stroke:"#C4C4C4"}),r.a.createElement(G.m,{dataKey:"date",tickMargin:5,tickLine:!1,axisLine:!1,stroke:"#C4C4C4"}),r.a.createElement(G.j,{y:t.monthlyPassCost?parseFloat(t.monthlyPassCost/100).toFixed(2):null,label:"Transit Pass Cost",stroke:"red"}),r.a.createElement(G.j,{y:(parseFloat(t.monthlyPassCost)/parseFloat(t.fareCost)/100).toFixed(2),label:"Transit Pass Break-even",stroke:"red"}),r.a.createElement(G.l,null))))},Pt=function(e){var t=e.dataset,a=e.budget;return t.data.forEach(function(e){var t=0;a&&(t=a.monthlyPassCost),e.costPerTapIfPass=(parseFloat(t)/(e.paymentTaps+e.transferTaps)).toFixed(2)}),console.log(t),r.a.createElement("div",null,r.a.createElement(Tt,{justify:"space-between",align:"center"},r.a.createElement("h3",{style:{marginTop:"0",marginBottom:"0",marginLeft:"25px",color:"#11BB81"}},"Cost Per Tap"),r.a.createElement("h3",{style:{marginTop:"0",marginRight:"30px",color:"#3BB4E9"}},"$".concat(t.costPerTap.toFixed(2)," / Tap"))),r.a.createElement(G.k,{height:200},r.a.createElement(G.g,{margin:{top:20,right:30,left:0,bottom:0},data:t.data},r.a.createElement(G.c,{stroke:"#EBEBEB",vertical:!1}),r.a.createElement(G.f,{dataKey:"costPerTap",type:"monotone",stroke:"#3BB4E9",strokeWidth:5,dot:{stroke:"white",strokeWidth:3,fill:"#3BB4E9",r:7}}),t.data[0]&&t.data[0].costPerTapIfPass>0&&r.a.createElement(G.f,{dataKey:"costPerTapIfPass",type:"monotone",stroke:"#3333cc",strokeWidth:5,dot:{stroke:"white",strokeWidth:3,fill:"#3333cc",r:7}}),r.a.createElement(G.n,{type:"number",tickMargin:20,dataKey:"costPerTap",tickLine:!1,axisLine:!1,stroke:"#C4C4C4"}),r.a.createElement(G.m,{dataKey:"date",tickMargin:5,tickLine:!1,axisLine:!1,stroke:"#C4C4C4"}),r.a.createElement(G.l,null))))},Nt=function(e){var t=e.dataset,a=t.data.length;return r.a.createElement("div",null,r.a.createElement(Tt,{justify:"space-between",align:"center"},r.a.createElement("h3",{style:{marginTop:"0",marginBottom:"0",marginLeft:"25px",color:"#11BB81"}},"Tap Overview"),r.a.createElement("h3",{style:{marginTop:"0",marginRight:"30px",color:"#3BB4E9"}},"".concat(t.totalTaps," Taps Total"))),r.a.createElement(G.k,{height:200},r.a.createElement(G.b,{margin:{top:20,right:30,left:0,bottom:0},data:t.data},r.a.createElement(G.c,{stroke:"#EBEBEB",vertical:!1}),r.a.createElement(G.l,null),r.a.createElement(G.a,{stackId:"a",dataKey:"paymentTaps",fill:"#3333cc"}),r.a.createElement(G.a,{stackId:"a",dataKey:"transferTaps",fill:"#3BB4E9"}),r.a.createElement(G.j,{y:t.totalTaps/a,label:"Average Monthly Taps",stroke:"red"}),r.a.createElement(G.n,{allowDecimals:!1,type:"number",dataKey:"paymentTaps",tickLine:!1,axisLine:!1}),r.a.createElement(G.m,{dataKey:"date",tickLine:!1,axisLine:!1}))))};var St=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(E.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={month:(new Date).getMonth(),year:(new Date).getFullYear(),activeIndex:0,selectedMonth:(new Date).getMonth(),selectedYear:(new Date).getFullYear()},a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){console.log("SUP?",this.props);var e=this.state,t=(e.year,e.month,e.selectedYear,e.selectedMonth,e.activeIndex,this.props.budget);(new Date).getMonth(),(new Date).getFullYear();return r.a.createElement(x.a,{url:"".concat(T.root).concat(T.yearToDateData.endpoint),options:T.send("GET")},function(e){var a={};return!e.loading&&e.error?r.a.createElement(z.a,{error:!0},e.error.message):(e.loading||(a=function(e){var t={data:[],totalAmount:0,totalTaps:0,costPerTap:0};Object.keys(e).forEach(function(a){Object.keys(e[a]).forEach(function(n){var r,o=e[a][n],l=o.amount,c=o.transactions,i=o.transitPassAmount,s="".concat((r=n,["January","February","March","April","May","June","July","August","September","October","November","December"].indexOf(r)+1),"/").concat(a),u=c.filter(function(e){return e.type.includes("Payment")}),d=c.filter(function(e){return e.type.includes("Transfer")}),m=Math.round(Math.round((l+i)/c.length));isNaN(m)&&(m=0),console.log(m),t.totalAmount+=l+i,t.totalTaps+=c.length,t.data.push({date:s,amount:Math.round(l+i)/100,costPerTap:m/100,paymentTaps:u.length,transferTaps:d.length,taps:c.length})})});var a=Math.round(t.totalAmount/t.totalTaps)/100;return isNaN(a)&&(a=0),console.log("HEYHEY:",a),t.costPerTap=a,t.totalAmount=Math.round(t.totalAmount).toFixed(2),t}(e.data.data)),r.a.createElement(r.a.Fragment,null,r.a.createElement(Tt,{padding:"0 0 10px 0"},r.a.createElement("div",{style:{width:"50%",marginRight:"10px"}},r.a.createElement(U.a,{vertical:!0,style:{minHeight:"250px"},loading:e.loading},!e.loading&&r.a.createElement(Ft,{dataset:a,budget:t}))),r.a.createElement("div",{style:{width:"50%"}},r.a.createElement(U.a,{vertical:!0,style:{minHeight:"250px"},loading:e.loading},!e.loading&&r.a.createElement(Pt,{dataset:a,budget:t})))),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(U.a,{vertical:!0,style:{minHeight:"250px"},loading:e.loading},!e.loading&&r.a.createElement(Nt,{dataset:a})))))})}}]),t}(n.Component),Dt=function(e){var t=e.props.data,a=t.user,n=(t.balance,t.budget),o=(t.lastActivity,t.spent);o.amount,o.since;return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.b,{path:"/dashboard/:cardNumber/:searchType/:yearOrRange/:monthOrUnit"},function(e){var t,o,l,c,s=e.match,u=e.history;return console.log(s,u),s?(t=s.params.cardNumber,o=s.params.searchType===P||"month"===s.params.searchType?s.params.searchType:"err",l=Math.abs(parseInt(s.params.yearOrRange,10)),c="days"!==s.params.monthOrUnit?Math.abs(parseInt(s.params.monthOrUnit,10)):"days",r.a.createElement(I,{cards:a.cards,history:u,match:s,cardNumber:t,searchType:o,yearOrRange:l,monthOrUnit:c},function(e){var t=e.data,a=e.error,o=e.loading;return console.log(t),r.a.createElement(d.a,{columns:"equal"},r.a.createElement(d.a.Row,null,r.a.createElement(d.a.Column,null,r.a.createElement(re,{data:t,error:a,loading:o,budget:n||{}}))),r.a.createElement(d.a.Row,null,r.a.createElement(d.a.Column,null,r.a.createElement(R,{data:t,error:a,loading:o}))),r.a.createElement(d.a.Row,null,r.a.createElement(d.a.Column,null,r.a.createElement(Pe,{data:t,error:a,loading:o})),r.a.createElement(d.a.Column,null)),r.a.createElement(m.a,{horizontal:!0},r.a.createElement(p.a,{as:"h3"},"Year Overview",r.a.createElement(p.a.Subheader,null,"Year To Month Overview"))),r.a.createElement(d.a.Row,null,r.a.createElement(d.a.Column,null,r.a.createElement(St,null))))})):(t="all",o=P,l=30,c="days",r.a.createElement(i.a,{to:"/dashboard/".concat(t,"/").concat(o,"/").concat(l,"/").concat(c)}))}))};function At(e){return r.a.createElement(jt,{loginRequired:!0},r.a.createElement(Mt.Consumer,null,function(e){return r.a.createElement(Dt,{props:e})}))}At.defaultProps={};function It(e){return r.a.createElement(jt,{loginRequired:!1},r.a.createElement(Je,null))}It.defaultProps={};var Yt=a(390),Lt=a(250),Bt=a(260),Rt=a.n(Bt),Ut=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(E.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={firstName:"",lastName:"",email:"",password:"",passwordAgain:""},a.saveToState=function(e){a.setState(Object(h.a)({},e.target.name,e.target.value))},a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.firstName,n=t.lastName,o=t.email,l=t.password,i=t.passwordAgain,s=this.props.incrementSteps;return r.a.createElement(x.a,{manual:!0,url:"".concat(T.root).concat(T.register),options:T.send({firstName:a,lastName:n,email:o,password:l,passwordAgain:i})},function(t){var u=t.fetch,d=t.loading,m=t.data,p=t.error;m&&(Rt.a.done(),s&&s());return r.a.createElement("div",{style:{minWidth:"50%"}},r.a.createElement(z.a,{attached:!0,header:"Register",content:"Fill out the form below to sign-up for a new account"}),p&&(Rt.a.done(),r.a.createElement("div",null,"ERROR:",p.message)),r.a.createElement(qe.a,{className:"attached fluid segment"},r.a.createElement(qe.a.Group,{widths:"equal"},r.a.createElement(qe.a.Input,{fluid:!0,label:"First Name",type:"text",placeholder:"First Name",value:a,onChange:e.saveToState,name:"firstName",disabled:d}),r.a.createElement(qe.a.Input,{fluid:!0,label:"Last Name",placeholder:"Last Name",type:"text",name:"lastName",onChange:e.saveToState,value:n,disabled:d})),r.a.createElement(qe.a.Input,{fluid:!0,placeholder:"Email",label:"Email",disabled:d,type:"text",name:"email",onChange:e.saveToState,value:o}),r.a.createElement(qe.a.Group,{widths:"equal"},r.a.createElement(qe.a.Input,{fluid:!0,placeholder:"Password",label:"Password",disabled:d,type:"password",name:"password",onChange:e.saveToState,value:l}),r.a.createElement(qe.a.Input,{fluid:!0,placeholder:"Password Again",disabled:d,label:"Password Again",type:"password",name:"passwordAgain",onChange:e.saveToState,value:i})),r.a.createElement(k.a,{positive:!0,labelPosition:"right",icon:"chevron circle right",content:"Next",disabled:d||!a||!n||!o||!l||!i||l!==i,loading:d,onClick:function(){Rt.a.start(),u(),e.setState({firstName:"",lastName:"",email:"",password:"",passwordAgain:""})}})),r.a.createElement(z.a,{attached:"bottom",warning:!0},r.a.createElement(C.a,{name:"help"}),"Already signed up?\xa0",r.a.createElement(c.b,{to:"/login"},"Login"),"\xa0instead."))})}}]),t}(n.Component),zt=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(E.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={activeStep:1,completedSteps:0},a.incrementSteps=function(){var e=a.state,t=e.activeStep,n=e.completedSteps;a.setState({activeStep:t+1,completedSteps:n+1})},a}return Object(y.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this.state,t=e.activeStep,a=e.completedSteps;return console.log(a>0,t),r.a.createElement(Yt.a,null,r.a.createElement(U.a,{basic:!0,textAlign:"center"},r.a.createElement(Lt.a.Group,{ordered:!0},r.a.createElement(Lt.a,{active:1===t,completed:a>0},r.a.createElement(Lt.a.Content,null,r.a.createElement(Lt.a.Title,null,"Sign Up"),r.a.createElement(Lt.a.Description,null,"Sign up for your account"))),r.a.createElement(Lt.a,{active:2===t,completed:a>1},r.a.createElement(Lt.a.Content,null,r.a.createElement(Lt.a.Title,null,"Presto"),r.a.createElement(Lt.a.Description,null,"Sign in to Presto"))),r.a.createElement(Lt.a,{active:3===t,completed:a>2},r.a.createElement(Lt.a.Content,null,r.a.createElement(Lt.a.Title,null,"Finalize"))))),r.a.createElement(U.a,{basic:!0},1===t&&r.a.createElement(Ut,{incrementSteps:this.incrementSteps}),2===t&&r.a.createElement(ft,{incrementSteps:this.incrementSteps}),3===t&&r.a.createElement("div",null,"ALL DONE")))}}]),t}(n.Component);function Wt(e){return r.a.createElement(jt,null,r.a.createElement(zt,null))}Wt.defaultProps={};function Ht(){return r.a.createElement(jt,{loginRequired:!0},r.a.createElement(Mt.Consumer,null,function(e){return console.log(e),r.a.createElement(ht,{props:e})}))}Ht.defaultProps={};var Gt=function(){return r.a.createElement(c.a,null,r.a.createElement(i.b,{exact:!0,path:"/",component:It}),r.a.createElement(i.b,{path:"/settings",component:Ht}),r.a.createElement(i.b,{path:"/dashboard",component:At}),r.a.createElement(i.b,{path:"/login",component:It}),r.a.createElement(i.b,{path:"/register",component:Wt}))};l.a.render(r.a.createElement(Gt,null),document.getElementById("root"))}},[[478,1,2]]]);
//# sourceMappingURL=main.01d0a78a.chunk.js.map